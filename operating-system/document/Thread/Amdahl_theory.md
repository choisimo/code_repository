## Threads, Process and Parallel Computing 

### Amdahl theory
시스템 일부를 개선할 때 얻을 수 있는 전체 성능 향상의 이론적 한계를 계산하는 공식이다.
```text
SpeedUp = 1 / [(1-p) + (p/N)]
```
- p 는 프로그램에서 병렬화 가능한 부분의 비율 (0 ~ 1)
- N 은 처리 코어 (프로세서)의 개수
- (1-p)는 순차적으로만 실행 가능한 부분의 비율

> 프로그램의 순차적 부분이 전체 성능 향상에 근본적인 제약을 가한다. 프로그램의 일정 부분이 순차적이기 때문에 무한대의 프로세서를 사용해도 일정량 속도 향상 이후에는 거의 처리 속도가 같음


# 스레드, 프로세스 및 병렬 컴퓨팅 개념 설명

## Amdahl의 법칙 이론적 배경

Amdahl의 법칙은 시스템 일부를 개선할 때 얻을 수 있는 전체 성능 향상의 이론적 한계를 계산하는 공식입니다. 병렬 컴퓨팅에서 특히 중요하며, 다음과 같이 표현됩니다:

```
Speedup = 1 / [(1-P) + (P/N)]
```

여기서:
- P는 프로그램에서 병렬화 가능한 부분의 비율 (0에서 1 사이)
- N은 처리 코어(프로세서)의 수
- (1-P)는 순차적으로만 실행 가능한 부분의 비율

이 법칙의 핵심적인 통찰은 프로그램의 순차적 부분이 전체 성능 향상에 근본적인 제약을 가한다는 것입니다. 예를 들어, 프로그램의 10%가 순차적이라면 무한대의 프로세서를 사용하더라도 10배 이상의 속도 향상은 불가능합니다.

## 사용자 수준 스레드 vs 커널 수준 스레드

### 사용자 수준 스레드(User-level Threads)
사용자 공간에서 구현되는 스레드로, 커널의 지원 없이 스레드 라이브러리를 통해 관리됩니다.

**특징:**
- 스레드 작업에 시스템 호출이 필요 없음(더 빠른 작업)
- 스레딩을 지원하지 않는 OS에서도 구현 가능
- 커널은 이러한 스레드의 존재를 인식하지 못함
- 한 스레드가 I/O에서 블록되면 동일 프로세스의 모든 스레드가 블록됨
- 스케줄링이 라이브러리에 의해 수행되어 유연성 제공

### 커널 수준 스레드(Kernel-level Threads)
OS에 의해 직접 지원되고 관리되는 스레드입니다.

**특징:**
- 스레드 작업에 시스템 호출 필요(오버헤드 증가)
- 커널이 모든 스레드를 완전히 인식함
- 한 스레드가 블록되어도 다른 스레드는 계속 실행 가능
- 멀티프로세서 시스템에서 다른 CPU에 스레드 할당 가능
- 스레드당 더 많은 시스템 리소스 필요

## 커널 수준 스레드 간의 컨텍스트 스위칭

컨텍스트 스위칭은 현재 실행 중인 스레드의 상태를 저장하고 다른 스레드로 전환하는 과정입니다. 커널 수준 스레드의 컨텍스트 스위칭에는 다음과 같은 단계가 포함됩니다:

1. **상태 저장**: 현재 스레드의 실행 컨텍스트(레지스터, 프로그램 카운터, 스택 포인터 등)를 Thread Control Block(TCB)에 저장

2. **스케줄링**: 스케줄러를 통해 다음에 실행할 스레드 선택

3. **상태 복원**: 선택된 스레드의 컨텍스트를 해당 TCB에서 로드

4. **주소 공간 전환**: 필요한 경우 새 스레드의 주소 공간으로 전환(같은 프로세스 내 스레드 간에는 필요 없음)

5. **실행 재개**: 저장된 프로그램 카운터 위치부터 실행 재개

커널 수준 스레드 간의 컨텍스트 스위칭은 주소 공간 전환이 필요 없는 경우가 많아 프로세스 간 전환보다 빠릅니다.

## 스레드 생성 vs 프로세스 생성 리소스

### 스레드 생성 시 사용되는 리소스
- 스레드 식별자(TID)
- 레지스터 세트(프로그램 카운터, 스택 포인터 등)
- 스택(로컬 변수와 함수 호출용)
- Thread Control Block(TCB)
- 스레드별 데이터(Thread-Local Storage)

### 프로세스 생성 시 사용되는 리소스
- 프로세스 식별자(PID)
- 메모리 공간(텍스트, 데이터, 힙 세그먼트)
- Process Control Block(PCB)
- 파일 디스크립터 테이블
- 보안 컨텍스트(사용자 ID, 그룹 ID)
- 최소 하나의 스레드(메인 스레드)

**핵심 차이점**: 동일 프로세스 내 스레드들은 메모리 공간, 파일 디스크립터, 보안 컨텍스트 등 대부분의 리소스를 공유하는 반면, 각 프로세스는 이러한 리소스의 개별 사본을 가집니다. 이로 인해 스레드 생성이 프로세스 생성보다 일반적으로 더 빠르고 리소스 효율적입니다.