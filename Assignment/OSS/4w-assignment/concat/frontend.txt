// íŒŒì¼: frontend/.eslintrc.js
module.exports = {
  root: true,
  env: {
    node: true
  },
  extends: [
    'plugin:vue/vue3-essential',
    'eslint:recommended'
  ],
  parserOptions: {
    ecmaVersion: 2020
  },
  rules: {}
}


// ===================================

// íŒŒì¼: frontend/postcss.config.js
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {}
  }
}


// ===================================

// íŒŒì¼: frontend/src/App.vue
<template>
  <div class="app-container">
    <header class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-4 shadow-lg">
      <div class="container mx-auto flex justify-between items-center">
        <h1 class="text-2xl font-bold">Nodove ë‚ ì”¨</h1>
        <nav>
          <router-link to="/" class="px-4 py-2 mr-2 hover:bg-blue-600 rounded-md transition-colors">í™ˆ</router-link>
          <router-link to="/map" class="px-4 py-2 hover:bg-blue-600 rounded-md transition-colors">ì§€ë„</router-link>
        </nav>
      </div>
    </header>
    
    <main class="container mx-auto p-4 min-h-screen">
      <router-view />
    </main>
    
    <footer class="bg-gray-800 text-white p-4 mt-8">
      <div class="container mx-auto text-center">
        <p>Â© 2023 Nodove ë‚ ì”¨ ì• í”Œë¦¬ì¼€ì´ì…˜</p>
      </div>
    </footer>
  </div>
</template>

<script>
export default {
  name: 'App'
}
</script>

<style lang="scss">
.app-container {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

main {
  flex: 1;
}
</style>


// ===================================

// íŒŒì¼: frontend/src/components/ErrorAlert.vue
<template>
    <div v-if="show" class="error-alert" :class="{ 'error-alert-show': show }">
      <div class="error-content">
        <div class="error-icon">âš ï¸</div>
        <div class="error-message">{{ message }}</div>
      </div>
      <button class="close-button" @click="close">Ã—</button>
    </div>
  </template>
  
  <script>
  import { ref, watch } from 'vue';
  
  export default {
    name: 'ErrorAlert',
    props: {
      message: {
        type: String,
        required: true
      },
      duration: {
        type: Number,
        default: 5000 // 5ì´ˆ í›„ ìë™ìœ¼ë¡œ ë‹«í˜
      },
      show: {
        type: Boolean,
        default: false
      }
    },
    emits: ['close'],
    setup(props, { emit }) {
      const timer = ref(null);
      
      const close = () => {
        emit('close');
      };
      
      watch(() => props.show, (newValue) => {
        if (newValue) {
          // ì´ì „ íƒ€ì´ë¨¸ê°€ ìˆìœ¼ë©´ ì œê±°
          if (timer.value) {
            clearTimeout(timer.value);
          }
          
          // ìƒˆ íƒ€ì´ë¨¸ ì„¤ì •
          timer.value = setTimeout(() => {
            close();
          }, props.duration);
        }
      });
      
      return {
        close
      };
    }
  };
  </script>
  
  <style scoped>
  .error-alert {
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
    border-radius: 4px;
    padding: 12px 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    max-width: 400px;
    transform: translateX(120%);
    transition: transform 0.3s ease-in-out;
  }
  
  .error-alert-show {
    transform: translateX(0);
  }
  
  .error-content {
    display: flex;
    align-items: center;
  }
  
  .error-icon {
    margin-right: 12px;
    font-size: 20px;
  }
  
  .error-message {
    font-size: 14px;
  }
  
  .close-button {
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    margin-left: 16px;
    color: #721c24;
  }
  </style>


// ===================================

// íŒŒì¼: frontend/src/components/WeatherForecast.vue
<template>
  <div class="weather-forecast">
    <div v-if="isLoading" class="loading-container">
      <div class="spinner"></div>
      <p>ë‚ ì”¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
    </div>
    
    <div v-else-if="error" class="error-container">
      <p class="error-message">{{ error }}</p>
      <button class="retry-button" @click="refreshData">ë‹¤ì‹œ ì‹œë„</button>
    </div>
    
    <div v-else-if="forecast.length" class="forecast-container">
      <h3 class="forecast-title">
        {{ selectedLocation.address }} ì¼ê¸° ì˜ˆë³´
      </h3>
      
      <div class="forecast-cards">
        <div 
          v-for="(item, index) in forecast" 
          :key="index" 
          class="forecast-card"
          :class="{ 'current-day': index === 0 }"
        >
          <div class="forecast-day">{{ formatDay(item.date) }}</div>
          <div class="forecast-icon">
            <img :src="getWeatherIconUrl(item.skyCode)" :alt="item.skyText" />
          </div>
          <div class="forecast-temp">
            <span class="high">{{ item.temperatureMax }}Â°</span>
            <span class="low">{{ item.temperatureMin }}Â°</span>
          </div>
          <div class="forecast-desc">{{ item.skyText }}</div>
          <div v-if="item.precipitation > 0" class="forecast-rain">
            <span class="rain-icon">ğŸ’§</span>
            <span class="rain-percent">{{ item.precipitation }}%</span>
          </div>
        </div>
      </div>
      
      <!-- ìƒì„¸ ë‚ ì”¨ ì •ë³´ -->
      <div class="weather-details" v-if="currentWeather">
        <div class="detail-row">
          <div class="detail-item">
            <div class="detail-label">ìŠµë„</div>
            <div class="detail-value">{{ currentWeather.humidity || 0 }}%</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">ê¸°ì••</div>
            <div class="detail-value">{{ currentWeather.pressure || 0 }} hPa</div>
          </div>
        </div>
        <div class="detail-row">
          <div class="detail-item">
            <div class="detail-label">í’ì†</div>
            <div class="detail-value">{{ currentWeather.windSpeed || 0 }} m/s</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">ì²´ê°ì˜¨ë„</div>
            <div class="detail-value">{{ currentWeather.temperatureFeelsLike || 0 }}Â°C</div>
          </div>
        </div>
      </div>
    </div>
    
    <div v-else class="empty-state">
      <p>ë‚ ì”¨ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
      <p>ì§€ë„ì—ì„œ ìœ„ì¹˜ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ì£¼ì†Œë¥¼ ê²€ìƒ‰í•´ì£¼ì„¸ìš”.</p>
    </div>
  </div>
</template>

<script>
import { computed, onMounted } from 'vue';
import { useWeatherStore } from '@/stores/weather';

export default {
  name: 'WeatherForecast',
  
  props: {
    // ë‚ ì”¨ ì˜ˆë³´ë¥¼ í‘œì‹œí•  ìœ„ì¹˜ (ì„ íƒì )
    location: {
      type: Object,
      default: null
    }
  },
  
  setup(props) {
    const weatherStore = useWeatherStore();
    
    // ë‚ ì”¨ ì •ë³´ì™€ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
    const forecast = computed(() => weatherStore.forecast || []);
    const currentWeather = computed(() => weatherStore.currentWeather);
    const isLoading = computed(() => weatherStore.loading);
    const error = computed(() => weatherStore.error);
    const selectedLocation = computed(() => weatherStore.selectedLocation);
    
    // í˜„ì¬ ìœ„ì¹˜ì— ëŒ€í•œ ë‚ ì”¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    const fetchData = async () => {
      // props.locationì´ ìˆìœ¼ë©´ í•´ë‹¹ ìœ„ì¹˜ë¡œ, ì—†ìœ¼ë©´ ì„ íƒëœ ìœ„ì¹˜ ì‚¬ìš©
      if (props.location) {
        await weatherStore.setLocation(
          props.location.lat, 
          props.location.lng, 
          props.location.address
        );
      } else {
        await weatherStore.fetchCurrentWeather();
        await weatherStore.fetchForecast();
      }
    };
    
    // ë‚ ì”¨ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
    const refreshData = async () => {
      await weatherStore.refreshAll();
    };
    
    // ë‚ ì§œ í¬ë§·íŒ… (ìš”ì¼ í‘œì‹œ)
    const formatDay = (dateString) => {
      if (!dateString) return '';
      
      const days = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
      const date = new Date(dateString);
      
      // ì˜¤ëŠ˜ì¸ì§€ í™•ì¸
      const today = new Date();
      if (date.setHours(0, 0, 0, 0) === today.setHours(0, 0, 0, 0)) {
        return 'ì˜¤ëŠ˜';
      }
      
      return days[date.getDay()] + 'ìš”ì¼';
    };
    
    // ë‚ ì”¨ ìƒíƒœì— ë”°ë¥¸ ì•„ì´ì½˜ URL ë°˜í™˜
    const getWeatherIconUrl = (skyCode) => {
      if (!skyCode) return '/icons/weather/unknown.svg';
      
      // ë‚ ì”¨ ì½”ë“œì— ë”°ë¥¸ ì•„ì´ì½˜ ë§¤í•‘
      const iconMap = {
        'CLEAR': 'clear-day',
        'PARTLY_CLOUDY': 'partly-cloudy-day',
        'MOSTLY_CLOUDY': 'cloudy',
        'CLOUDY': 'cloudy',
        'RAIN': 'rain',
        'SNOW': 'snow',
        'SLEET': 'sleet',
        'THUNDERSTORM': 'thunderstorm'
      };
      
      const iconName = iconMap[skyCode] || 'unknown';
      return `/icons/weather/${iconName}.svg`;
    };
    
    // ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ ë°ì´í„° ë¡œë“œ
    onMounted(() => {
      fetchData();
    });
    
    return {
      forecast,
      currentWeather,
      isLoading,
      error,
      selectedLocation,
      refreshData,
      formatDay,
      getWeatherIconUrl
    };
  }
};
</script>

<style lang="scss" scoped>
.weather-forecast {
  width: 100%;
  padding: 1rem;
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  margin-bottom: 1.5rem;
  
  .loading-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    
    .spinner {
      width: 30px;
      height: 30px;
      border: 3px solid rgba(0, 0, 0, 0.1);
      border-top-color: #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 1rem;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  }
  
  .error-container {
    text-align: center;
    padding: 1.5rem;
    
    .error-message {
      color: #e74c3c;
      margin-bottom: 1rem;
    }
    
    .retry-button {
      padding: 0.5rem 1rem;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s;
      
      &:hover {
        background: #2980b9;
      }
    }
  }
  
  .forecast-container {
    .forecast-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: #2c3e50;
      text-align: center;
    }
    
    .forecast-cards {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 0.5rem 0;
      
      &::-webkit-scrollbar {
        height: 4px;
      }
      
      &::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.05);
        border-radius: 10px;
      }
      
      &::-webkit-scrollbar-thumb {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
      }
    }
    
    .forecast-card {
      flex: 0 0 auto;
      width: 90px;
      padding: 0.8rem;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.7);
      text-align: center;
      transition: transform 0.2s, box-shadow 0.2s;
      
      &:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
      }
      
      &.current-day {
        background: rgba(52, 152, 219, 0.1);
        border: 1px solid rgba(52, 152, 219, 0.3);
      }
      
      .forecast-day {
        font-size: 0.8rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: #34495e;
      }
      
      .forecast-icon {
        margin: 0.5rem 0;
        
        img {
          width: 40px;
          height: 40px;
        }
      }
      
      .forecast-temp {
        margin: 0.5rem 0;
        
        .high {
          font-weight: 600;
          color: #e74c3c;
          margin-right: 0.5rem;
        }
        
        .low {
          color: #3498db;
        }
      }
      
      .forecast-desc {
        font-size: 0.75rem;
        color: #7f8c8d;
        margin-bottom: 0.5rem;
      }
      
      .forecast-rain {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        color: #3498db;
        
        .rain-icon {
          margin-right: 0.2rem;
        }
      }
    }
  }
  
  .weather-details {
    margin-top: 1.5rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    
    .detail-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.8rem;
    }
    
    .detail-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      
      .detail-label {
        font-size: 0.8rem;
        color: #7f8c8d;
        margin-bottom: 0.2rem;
      }
      
      .detail-value {
        font-size: 1rem;
        font-weight: 600;
        color: #2c3e50;
      }
    }
  }
  
  .empty-state {
    text-align: center;
    padding: 2rem;
    color: #7f8c8d;
  }
}

@media (max-width: 768px) {
  .weather-forecast {
    padding: 0.8rem;
    
    .forecast-container {
      .forecast-cards {
        .forecast-card {
          width: 80px;
          padding: 0.6rem;
        }
      }
    }
  }
}
</style>


// ===================================

// íŒŒì¼: frontend/src/components/WeatherMap.vue
<template>
  <div class="weather-map-container">
    <div v-if="loading" class="loading-overlay">
      <div class="loading-spinner"></div>
      <p>ë‚ ì”¨ ë°ì´í„° ë¡œë”© ì¤‘...</p>
    </div>
    <div v-if="error" class="error-message">
      <p>{{ error }}</p>
      <button @click="fetchWeatherData" class="retry-button">ë‹¤ì‹œ ì‹œë„</button>
    </div>
    <div id="weather-map" ref="mapContainer" class="map-container"></div>
    <div class="map-controls">
      <button @click="zoomIn" class="map-control-button">+</button>
      <button @click="zoomOut" class="map-control-button">-</button>
      <button @click="resetLocation" class="map-control-button">
        <span class="reset-icon">âŸ³</span>
      </button>
    </div>
    <div v-if="selectedLocation" class="location-info">
      <h3>{{ selectedLocation.name }}</h3>
      <div class="weather-details">
        <div class="weather-icon">
          <img :src="getWeatherIconUrl(selectedLocation.weather.icon)" :alt="selectedLocation.weather.description" />
        </div>
        <div class="weather-data">
          <p class="temperature">{{ Math.round(selectedLocation.weather.temp) }}Â°C</p>
          <p class="description">{{ selectedLocation.weather.description }}</p>
          <p class="humidity">ìŠµë„: {{ selectedLocation.weather.humidity }}%</p>
          <p class="wind">í’ì†: {{ selectedLocation.weather.windSpeed }} m/s</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { ref, onMounted, onUnmounted } from 'vue';
import axios from 'axios';

export default {
  name: 'WeatherMap',
  props: {
    initialLat: {
      type: Number,
      default: 37.5665 // ì„œìš¸ì˜ ìœ„ë„
    },
    initialLng: {
      type: Number,
      default: 126.9780 // ì„œìš¸ì˜ ê²½ë„
    },
    zoom: {
      type: Number,
      default: 10
    },
    naverMapsClientId: {
      type: String,
      required: true
    }
  },
  setup(props) {
    const mapContainer = ref(null);
    const map = ref(null);
    const markers = ref([]);
    const loading = ref(true);
    const error = ref(null);
    const selectedLocation = ref(null);
    const weatherData = ref([]);

    // ë‚ ì”¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    const fetchWeatherData = async () => {
      if (!map.value) return;
      
      loading.value = true;
      error.value = null;
      
      try {
        // API í˜¸ì¶œ
        const response = await axios.get('/api/weather/regions');
        
        weatherData.value = response.data;
        clearMarkers();
        addWeatherMarkers();
      } catch (err) {
        console.error('ë‚ ì”¨ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:', err);
        error.value = 'ë‚ ì”¨ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.';
      } finally {
        loading.value = false;
      }
    };

    // ì§€ë„ ì´ˆê¸°í™”
    const initMap = () => {
      if (!window.naver || !window.naver.maps) {
        error.value = "ë„¤ì´ë²„ ì§€ë„ APIê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";
        loading.value = false;
        return;
      }

      map.value = new window.naver.maps.Map(mapContainer.value, {
        center: new window.naver.maps.LatLng(props.initialLat, props.initialLng),
        zoom: props.zoom,
        zoomControl: false,
        mapTypeControl: false
      });

      // ì§€ë„ ë¡œë”© ì™„ë£Œ ì´ë²¤íŠ¸ - ë„¤ì´ë²„ ì§€ë„ëŠ” 'init' ì´ë²¤íŠ¸ ì‚¬ìš©
      window.naver.maps.Event.addListener(map.value, 'init', () => {
        fetchWeatherData();
      });

      // ì§€ë„ í´ë¦­ ì´ë²¤íŠ¸
      window.naver.maps.Event.addListener(map.value, 'click', () => {
        selectedLocation.value = null;
      });
    };

    // ë§ˆì»¤ ì´ˆê¸°í™”
    const clearMarkers = () => {
      markers.value.forEach(marker => marker.setMap(null));
      markers.value = [];
    };

    // ë‚ ì”¨ ë§ˆì»¤ ì¶”ê°€
    const addWeatherMarkers = () => {
      if (!weatherData.value || !Array.isArray(weatherData.value)) return;
      
      weatherData.value.forEach(location => {
        const marker = new window.naver.maps.Marker({
          position: new window.naver.maps.LatLng(location.lat, location.lng),
          map: map.value,
          title: location.name,
          icon: {
            url: getWeatherIconUrl(location.weather.icon),
            size: new window.naver.maps.Size(50, 50),
            scaledSize: new window.naver.maps.Size(50, 50)
          }
        });

        window.naver.maps.Event.addListener(marker, 'click', () => {
          selectedLocation.value = location;
        });

        markers.value.push(marker);
      });
    };

    // ë‚ ì”¨ ì•„ì´ì½˜ URL ê°€ì ¸ì˜¤ê¸°
    const getWeatherIconUrl = (iconCode) => {
      return `https://openweathermap.org/img/wn/${iconCode}@2x.png`;
    };

    // í™•ëŒ€
    const zoomIn = () => {
      if (map.value) {
        map.value.setZoom(map.value.getZoom() + 1);
      }
    };

    // ì¶•ì†Œ
    const zoomOut = () => {
      if (map.value) {
        map.value.setZoom(map.value.getZoom() - 1);
      }
    };

    // ìœ„ì¹˜ ì¬ì„¤ì •
    const resetLocation = () => {
      if (map.value) {
        map.value.setCenter(new window.naver.maps.LatLng(props.initialLat, props.initialLng));
        map.value.setZoom(props.zoom);
      }
    };

    // ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ
    onMounted(() => {
      if (window.naver && window.naver.maps) {
        initMap();
      } else {
        const script = document.createElement('script');
        script.src = `https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=${props.naverMapsClientId}&submodules=geocoder`;
        script.async = true;
        script.defer = true;
        
        script.onload = () => {
          initMap();
        };
        
        script.onerror = () => {
          error.value = "ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";
          loading.value = false;
        };
        
        document.head.appendChild(script);
      }
    });

    // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì •ë¦¬
    onUnmounted(() => {
      if (window.naver && window.naver.maps) {
        clearMarkers();
      }
    });

    return {
      mapContainer,
      loading,
      error,
      selectedLocation,
      fetchWeatherData,
      getWeatherIconUrl,
      zoomIn,
      zoomOut,
      resetLocation
    };
  }
};
</script>

<style scoped>
.weather-map-container {
  position: relative;
  width: 100%;
  height: 500px;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.map-container {
  width: 100%;
  height: 100%;
}

.loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(255, 255, 255, 0.8);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 10;
}

.loading-spinner {
  width: 50px;
  height: 50px;
  border: 5px solid #f3f3f3;
  border-top: 5px solid #3498db;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 10px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.error-message {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  text-align: center;
  z-index: 10;
}

.retry-button {
  background-color: #3498db;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  margin-top: 10px;
}

.retry-button:hover {
  background-color: #2980b9;
}

.map-controls {
  position: absolute;
  top: 10px;
  right: 10px;
  display: flex;
  flex-direction: column;
  gap: 5px;
  z-index: 5;
}

.map-control-button {
  width: 36px;
  height: 36px;
  background-color: white;
  border: 1px solid #ccc;
  border-radius: 4px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 18px;
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.map-control-button:hover {
  background-color: #f5f5f5;
}

.reset-icon {
  font-size: 16px;
}

.location-info {
  position: absolute;
  bottom: 20px;
  left: 20px;
  background-color: white;
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  max-width: 280px;
  z-index: 5;
}

.location-info h3 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 18px;
  font-weight: 600;
}

.weather-details {
  display: flex;
  align-items: center;
}

.weather-icon {
  flex-shrink: 0;
  margin-right: 10px;
}

.weather-icon img {
  width: 60px;
  height: 60px;
}

.weather-data {
  flex-grow: 1;
}

.temperature {
  font-size: 24px;
  font-weight: 700;
  margin: 0;
}

.description {
  text-transform: capitalize;
  margin: 5px 0;
}

.humidity, .wind {
  font-size: 14px;
  margin: 3px 0;
  color: #555;
}
</style>


// ===================================

// íŒŒì¼: frontend/src/main.js
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'
import router from './router'
import './assets/styles/tailwind.css'

const app = createApp(App)
app.use(createPinia())
app.use(router)
app.mount('#app')


// ===================================

// íŒŒì¼: frontend/src/router/index.js
import { createRouter, createWebHistory } from 'vue-router'
import HomeView from '../views/HomeView.vue'

const routes = [
  {
    path: '/',
    name: 'home',
    component: HomeView
  },
  {
    path: '/map',
    name: 'map',
    component: () => import(/* webpackChunkName: "map" */ '../views/MapView.vue')
  }
]

const router = createRouter({
  history: createWebHistory(process.env.BASE_URL),
  routes
})

export default router


// ===================================

// íŒŒì¼: frontend/src/services/api.js
import axios from 'axios';

// ê¸°ë³¸ API í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
const apiClient = axios.create({
  baseURL: process.env.VUE_APP_API_BASE_URL || '/api',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json',
    'Accept': 'application/json'
  }
});

// ë‚ ì”¨ ê´€ë ¨ API í˜¸ì¶œ
export const weatherApi = {
  /**
   * íŠ¹ì • ì¢Œí‘œì˜ í˜„ì¬ ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
   * @param {number} lat - ìœ„ë„
   * @param {number} lng - ê²½ë„
   * @returns {Promise} ë‚ ì”¨ ì •ë³´ ê°ì²´
   */
  getCurrentWeather(lat, lng) {
    return apiClient.get('/weather', {
      params: { lat, lng }
    });
  },

  /**
   * íŠ¹ì • ì¢Œí‘œì˜ ë‚ ì”¨ ì˜ˆë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
   * @param {number} lat - ìœ„ë„
   * @param {number} lng - ê²½ë„
   * @param {number} days - ì˜ˆë³´ ì¼ìˆ˜ (ê¸°ë³¸ê°’: 5)
   * @returns {Promise} ì˜ˆë³´ ì •ë³´ ê°ì²´
   */
  getForecast(lat, lng, days = 5) {
    return apiClient.get('/forecast', {
      params: { lat, lng, days }
    });
  },

  /**
   * ì£¼ì†Œë¥¼ ì¢Œí‘œë¡œ ë³€í™˜í•©ë‹ˆë‹¤ (ì§€ì˜¤ì½”ë”©).
   * @param {string} address - ë³€í™˜í•  ì£¼ì†Œ
   * @returns {Promise} ì¢Œí‘œ ì •ë³´ ê°ì²´
   */
  getCoordinates(address) {
    return apiClient.get('/geocode', {
      params: { address }
    });
  }
};

export default apiClient;


// ===================================

// íŒŒì¼: frontend/src/stores/weather.js
import { defineStore } from 'pinia';
import { weatherApi } from '@/services/api';

export const useWeatherStore = defineStore('weather', {
  state: () => ({
    currentWeather: null,
    forecast: [],
    loading: false,
    error: null,
    selectedLocation: {
      lat: 37.5665, // ì„œìš¸ ê¸°ë³¸ ì¢Œí‘œ
      lng: 126.9780,
      address: 'ì„œìš¸íŠ¹ë³„ì‹œ'
    },
    locations: [], // ìµœê·¼ ì¡°íšŒí•œ ìœ„ì¹˜ ëª©ë¡
  }),

  getters: {
    // ë‚ ì”¨ ìƒíƒœì— ë”°ë¥¸ ì•„ì´ì½˜ ì½”ë“œ ë°˜í™˜
    getWeatherIcon: (state) => {
      if (!state.currentWeather) return 'unknown';
      
      const weatherState = state.currentWeather.sky?.code || 'CLEAR';
      const isNight = state.currentWeather.isNight;
      
      switch (weatherState) {
        case 'CLEAR':
          return isNight ? 'clear-night' : 'clear-day';
        case 'PARTLY_CLOUDY':
          return isNight ? 'partly-cloudy-night' : 'partly-cloudy-day';
        case 'MOSTLY_CLOUDY':
        case 'CLOUDY':
          return 'cloudy';
        case 'RAIN':
          return 'rain';
        case 'SNOW':
          return 'snow';
        case 'SLEET':
          return 'sleet';
        case 'THUNDERSTORM':
          return 'thunderstorm';
        default:
          return 'unknown';
      }
    },
    
    // ì˜¨ë„ì— ë”°ë¥¸ ìƒ‰ìƒ ë°˜í™˜
    getTemperatureColor: (state) => {
      if (!state.currentWeather) return '#888888';
      
      const temp = state.currentWeather.temperature?.current;
      if (temp === undefined) return '#888888';
      
      if (temp <= 0) return '#4287f5';  // ë§¤ìš° ì¶”ì›€ (íŒŒë€ìƒ‰)
      if (temp <= 10) return '#42adf5'; // ì¶”ì›€ (í•˜ëŠ˜ìƒ‰)
      if (temp <= 20) return '#42f59e'; // ì‹œì›í•¨ (ì—°ë‘ìƒ‰)
      if (temp <= 25) return '#f5d442'; // ë”°ëœ»í•¨ (ë…¸ë€ìƒ‰)
      if (temp <= 30) return '#f59442'; // ë”ì›€ (ì£¼í™©ìƒ‰)
      return '#f54242';                // ë§¤ìš° ë”ì›€ (ë¹¨ê°„ìƒ‰)
    }
  },

  actions: {
    /**
     * í˜„ì¬ ì„ íƒëœ ìœ„ì¹˜ì˜ ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
     */
    async fetchCurrentWeather() {
      if (!this.selectedLocation) return;
      
      const { lat, lng } = this.selectedLocation;
      this.loading = true;
      this.error = null;
      
      try {
        const response = await weatherApi.getCurrentWeather(lat, lng);
        this.currentWeather = response.data;
        
        // ìµœê·¼ ìœ„ì¹˜ ëª©ë¡ì— ì¶”ê°€
        this.addToRecentLocations({
          ...this.selectedLocation,
          weather: this.currentWeather
        });
      } catch (err) {
        this.error = err.message || 'ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
        console.error('ë‚ ì”¨ ì •ë³´ ì¡°íšŒ ì˜¤ë¥˜:', err);
      } finally {
        this.loading = false;
      }
    },
    
    /**
     * í˜„ì¬ ì„ íƒëœ ìœ„ì¹˜ì˜ ë‚ ì”¨ ì˜ˆë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
     * @param {number} days - ì˜ˆë³´ ì¼ìˆ˜
     */
    async fetchForecast(days = 5) {
      if (!this.selectedLocation) return;
      
      const { lat, lng } = this.selectedLocation;
      this.loading = true;
      this.error = null;
      
      try {
        const response = await weatherApi.getForecast(lat, lng, days);
        this.forecast = response.data.forecastList || [];
      } catch (err) {
        this.error = err.message || 'ë‚ ì”¨ ì˜ˆë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
        console.error('ë‚ ì”¨ ì˜ˆë³´ ì¡°íšŒ ì˜¤ë¥˜:', err);
      } finally {
        this.loading = false;
      }
    },
    
    /**
     * ì£¼ì†Œë¥¼ ê²€ìƒ‰í•˜ì—¬ ì¢Œí‘œë¡œ ë³€í™˜í•˜ê³  í•´ë‹¹ ìœ„ì¹˜ì˜ ë‚ ì”¨ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
     * @param {string} address - ê²€ìƒ‰í•  ì£¼ì†Œ
     */
    async searchByAddress(address) {
      if (!address) return;
      
      this.loading = true;
      this.error = null;
      
      try {
        const response = await weatherApi.getCoordinates(address);
        const { lat, lng, formattedAddress } = response.data;
        
        this.selectedLocation = {
          lat,
          lng,
          address: formattedAddress
        };
        
        // ë‚ ì”¨ ì •ë³´ ë° ì˜ˆë³´ ê°€ì ¸ì˜¤ê¸°
        await this.fetchCurrentWeather();
        await this.fetchForecast();
      } catch (err) {
        this.error = err.message || 'ì£¼ì†Œ ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
        console.error('ì£¼ì†Œ ê²€ìƒ‰ ì˜¤ë¥˜:', err);
      } finally {
        this.loading = false;
      }
    },
    
    /**
     * ì¢Œí‘œë¡œ ë‚ ì”¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
     * @param {number} lat - ìœ„ë„
     * @param {number} lng - ê²½ë„
     * @param {string} address - ì£¼ì†Œ (ì„ íƒì‚¬í•­)
     */
    async setLocation(lat, lng, address = 'ì„ íƒí•œ ìœ„ì¹˜') {
      this.selectedLocation = { lat, lng, address };
      await this.fetchCurrentWeather();
      await this.fetchForecast();
    },
    
    /**
     * ìµœê·¼ ìœ„ì¹˜ ëª©ë¡ì— ìœ„ì¹˜ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
     * @param {Object} location - ì¶”ê°€í•  ìœ„ì¹˜ ì •ë³´
     */
    addToRecentLocations(location) {
      // ì¤‘ë³µ ìœ„ì¹˜ ì²´í¬
      const exists = this.locations.some(loc => 
        loc.lat === location.lat && loc.lng === location.lng
      );
      
      if (!exists) {
        // ìµœëŒ€ 5ê°œê¹Œì§€ë§Œ ì €ì¥
        if (this.locations.length >= 5) {
          this.locations.pop();
        }
        
        this.locations.unshift(location);
      }
    },
    
    /**
     * ëª¨ë“  ë‚ ì”¨ ì •ë³´ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.
     */
    async refreshAll() {
      await this.fetchCurrentWeather();
      await this.fetchForecast();
    }
  }
});


// ===================================

// íŒŒì¼: frontend/src/views/HomeView.vue
<template>
  <div class="home">
    <div class="glass-card p-6 rounded-xl shadow-xl backdrop-blur-md bg-white/30 max-w-xl mx-auto">
      <h1 class="text-3xl font-bold mb-4 text-center text-gray-800">ë‚ ì”¨ ì •ë³´ ì„œë¹„ìŠ¤</h1>
      <p class="mb-6 text-gray-700">
        ë„¤ì´ë²„ ì§€ë„ APIì™€ ê³µê³µë°ì´í„° í¬í„¸ì˜ ë‚ ì”¨ APIë¥¼ í™œìš©í•˜ì—¬ 
        í˜„ì¬ ìœ„ì¹˜ ë° ê²€ìƒ‰í•œ ì§€ì—­ì˜ ë‚ ì”¨ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
      <div class="flex justify-center">
        <router-link 
          to="/map" 
          class="px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg shadow-md hover:shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
          ì§€ë„ë¡œ ë‚ ì”¨ ë³´ê¸°
        </router-link>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'HomeView'
}
</script>

<style scoped>
.home {
  padding: 2rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 70vh;
}

.glass-card {
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}
</style>


// ===================================

// íŒŒì¼: frontend/src/views/MapView.vue
<template>
  <div class="map-container">
    <ErrorAlert 
      :message="errorMessage" 
      :show="showError" 
      @close="showError = false" 
    />
    
    <div class="glass-card p-4 mb-4 rounded-lg">
      <h2 class="text-2xl font-bold mb-2 text-gray-800">ì§€ë„ ë‚ ì”¨</h2>
      <p class="text-gray-700 mb-4">ì§€ë„ì—ì„œ ì›í•˜ëŠ” ìœ„ì¹˜ë¥¼ í´ë¦­í•˜ì—¬ í•´ë‹¹ ì§€ì—­ì˜ ë‚ ì”¨ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
      
      <div class="search-box mb-4">
        <input 
          type="text" 
          v-model="searchQuery" 
          @keyup.enter="searchLocation"
          placeholder="ì§€ì—­ ê²€ìƒ‰" 
          class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
        <button 
          @click="searchLocation" 
          class="mt-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"
        >
          ê²€ìƒ‰
        </button>
      </div>
    </div>
    
    <WeatherMap 
      :initialLat="initialLocation.lat" 
      :initialLng="initialLocation.lng" 
      :zoom="zoom"
      :naverMapsClientId="naverMapsClientId"
    />
    
    <WeatherForecast v-if="selectedLocation" :location="selectedLocation" class="mt-4" />
  </div>
</template>

<script>
import { ref } from 'vue';
import { useWeatherStore } from '@/stores/weather';
import WeatherMap from '@/components/WeatherMap.vue';
import WeatherForecast from '@/components/WeatherForecast.vue';
import ErrorAlert from '@/components/ErrorAlert.vue';

export default {
  name: 'MapView',
  components: {
    WeatherMap,
    WeatherForecast,
    ErrorAlert
  },
  setup() {
    const weatherStore = useWeatherStore();
    const searchQuery = ref('');
    const initialLocation = ref({
      lat: 37.5665, // ì„œìš¸ì˜ ìœ„ë„
      lng: 126.9780 // ì„œìš¸ì˜ ê²½ë„
    });
    const zoom = ref(10);
    const naverMapsClientId = process.env.VUE_APP_NAVER_MAPS_CLIENT_ID || '';
    
    const selectedLocation = ref(weatherStore.selectedLocation);
    const errorMessage = ref('');
    const showError = ref(false);
    
    // ìœ„ì¹˜ ê²€ìƒ‰
    const searchLocation = async () => {
      if (!searchQuery.value.trim()) return;
      
      try {
        await weatherStore.searchByAddress(searchQuery.value);
        
        // ê²€ìƒ‰ ì„±ê³µ ì‹œ ì´ˆê¸° ìœ„ì¹˜ ì—…ë°ì´íŠ¸
        if (weatherStore.selectedLocation) {
          initialLocation.value = {
            lat: weatherStore.selectedLocation.lat,
            lng: weatherStore.selectedLocation.lng
          };
          selectedLocation.value = weatherStore.selectedLocation;
          zoom.value = 13; // ê²€ìƒ‰ ì‹œ ì¤Œ ë ˆë²¨ ì¡°ì •
        }
      } catch (err) {
        console.error('ìœ„ì¹˜ ê²€ìƒ‰ ì˜¤ë¥˜:', err);
        errorMessage.value = 'ìœ„ì¹˜ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + (err.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜');
        showError.value = true;
      }
    };
    
    return {
      searchQuery,
      initialLocation,
      zoom,
      selectedLocation,
      searchLocation,
      naverMapsClientId,
      errorMessage,
      showError
    };
  }
};
</script>

<style scoped>
.map-container {
  padding: 1rem;
}

.glass-card {
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.search-box {
  display: flex;
  flex-direction: column;
}

@media (min-width: 640px) {
  .search-box {
    flex-direction: row;
    gap: 8px;
  }
  
  .search-box button {
    margin-top: 0;
  }
}
</style>


// ===================================

// íŒŒì¼: frontend/tailwind.config.js
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./src/**/*.{vue,js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          light: '#6596ff',
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./src/**/*.{vue,js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          light: '#6596ff',
          DEFAULT: '#4070f4',
          dark: '#2c4eaf'
        },
      },
      fontFamily: {
        sans: ['Noto Sans KR', 'Roboto', 'sans-serif'],
      },
    },
  },
  plugins: [],
}


// ===================================

// íŒŒì¼: frontend/vue.config.js
const { defineConfig } = require('@vue/cli-service')

module.exports = defineConfig({
  transpileDependencies: true,
  
  // ê°œë°œ ì„œë²„ ì„¤ì •
  devServer: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8081',
        changeOrigin: true
      }
    }
  },
  
  // í”„ë¡œë•ì…˜ ë¹Œë“œ ì„¤ì •
  outputDir: 'dist',
  assetsDir: 'assets',
  
  // CSS ì„¤ì •
  css: {
    loaderOptions: {
      scss: {
        additionalData: (content, loaderContext) => {
          if (loaderContext.resourcePath.endsWith('variables.scss')) {
            return content
          }
          return `@import "@/assets/styles/variables.scss";\n${content}`
        }
      }
    }
  }
})


// ===================================

